{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Irfan/Downloads/OOM%20Mini%20project/lib/db.ts"],"sourcesContent":["interface ParkingLot {\n  id: number\n  name: string\n  address: string\n  total_slots: number\n  city: string\n  available_slots: number\n}\n\ninterface ParkingSlot {\n  id: number\n  lot_id: number\n  slot_number: string\n  slot_type: string\n  status: 'available' | 'booked' | 'maintenance' | 'reserved'\n  occupancy_status: 'empty' | 'occupied'\n  sensor_id: string\n  last_sensor_update: string\n}\n\ninterface Booking {\n  id: number\n  user_id: number\n  slot_id: number\n  booking_reference: string\n  start_time: string\n  end_time: string | null\n  booking_status: 'pending' | 'active' | 'completed' | 'cancelled'\n  total_amount: number\n  vehicle_number: string\n}\n\n// Simulated database storage\nexport const database = {\n  parkingLots: [\n    { id: 1, name: 'Downtown Plaza', address: '123 Main Street', total_slots: 120, city: 'New York', available_slots: 24 },\n    { id: 2, name: 'Central Station', address: '456 Station Ave', total_slots: 200, city: 'New York', available_slots: 45 },\n    { id: 3, name: 'Mall Parking', address: '789 Shopping Way', total_slots: 150, city: 'New York', available_slots: 12 },\n    { id: 4, name: 'Business District', address: '321 Corporate Blvd', total_slots: 180, city: 'New York', available_slots: 67 }\n  ] as ParkingLot[],\n\n  slots: [] as ParkingSlot[],\n  bookings: [] as Booking[],\n  users: [] as any[],\n  sensorLogs: [] as any[]\n}\n\n// Initialize slots for demo\nexport function initializeSlots() {\n  const slots: ParkingSlot[] = []\n  const sensorTypes = ['PIR', 'Ultrasonic', 'Camera', 'Magnetic']\n\n  database.parkingLots.forEach(lot => {\n    for (let i = 1; i <= lot.total_slots; i++) {\n      const isOccupied = Math.random() < 0.65\n      slots.push({\n        id: slots.length + 1,\n        lot_id: lot.id,\n        slot_number: `${String.fromCharCode(64 + Math.ceil(i / 20))}-${String(i % 20 || 20).padStart(2, '0')}`,\n        slot_type: i % 10 === 0 ? 'ev_charging' : i % 15 === 0 ? 'disabled' : 'standard',\n        status: isOccupied ? 'booked' : 'available',\n        occupancy_status: isOccupied ? 'occupied' : 'empty',\n        sensor_id: `SENSOR-${lot.id}-${i}`,\n        last_sensor_update: new Date().toISOString()\n      })\n    }\n  })\n\n  database.slots = slots\n}\n\n// Database query functions\nexport async function getParkingLots() {\n  return database.parkingLots\n}\n\nexport async function getParkingSlots(lotId?: number) {\n  if (lotId) {\n    return database.slots.filter(s => s.lot_id === lotId)\n  }\n  return database.slots\n}\n\nexport async function getSlotsByStatus(status: string) {\n  return database.slots.filter(s => s.status === status)\n}\n\nexport async function updateSlotStatus(slotId: number, status: string) {\n  const slot = database.slots.find(s => s.id === slotId)\n  if (slot) {\n    slot.status = status as any\n    slot.occupancy_status = status === 'booked' ? 'occupied' : 'empty'\n    slot.last_sensor_update = new Date().toISOString()\n  }\n  return slot\n}\n\nexport async function createBooking(booking: Partial<Booking>) {\n  const newBooking: Booking = {\n    id: database.bookings.length + 1,\n    user_id: booking.user_id!,\n    slot_id: booking.slot_id!,\n    booking_reference: `BK-${Date.now()}`,\n    start_time: booking.start_time!,\n    end_time: booking.end_time || null,\n    booking_status: 'pending',\n    total_amount: booking.total_amount || 0,\n    vehicle_number: booking.vehicle_number!\n  }\n  database.bookings.push(newBooking)\n  return newBooking\n}\n\nexport async function getBookings(userId?: number) {\n  if (userId) {\n    return database.bookings.filter(b => b.user_id === userId)\n  }\n  return database.bookings\n}\n\nexport async function logSensorData(sensorData: any) {\n  database.sensorLogs.push({\n    id: database.sensorLogs.length + 1,\n    timestamp: new Date().toISOString(),\n    ...sensorData\n  })\n}\n\nexport async function getAnalytics(lotId: number, date?: string) {\n  const dateStr = date || new Date().toISOString().split('T')[0]\n  const lotBookings = database.bookings.filter(b => b.lot_id === lotId)\n  const totalRevenue = lotBookings.reduce((sum, b) => sum + b.total_amount, 0)\n\n  return {\n    lot_id: lotId,\n    date: dateStr,\n    total_bookings: lotBookings.length,\n    total_revenue: totalRevenue,\n    average_occupancy: ((database.slots.filter(s => s.lot_id === lotId && s.occupancy_status === 'occupied').length / database.slots.filter(s => s.lot_id === lotId).length) * 100).toFixed(2)\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAiCO,MAAM,WAAW;IACtB,aAAa;QACX;YAAE,IAAI;YAAG,MAAM;YAAkB,SAAS;YAAmB,aAAa;YAAK,MAAM;YAAY,iBAAiB;QAAG;QACrH;YAAE,IAAI;YAAG,MAAM;YAAmB,SAAS;YAAmB,aAAa;YAAK,MAAM;YAAY,iBAAiB;QAAG;QACtH;YAAE,IAAI;YAAG,MAAM;YAAgB,SAAS;YAAoB,aAAa;YAAK,MAAM;YAAY,iBAAiB;QAAG;QACpH;YAAE,IAAI;YAAG,MAAM;YAAqB,SAAS;YAAsB,aAAa;YAAK,MAAM;YAAY,iBAAiB;QAAG;KAC5H;IAED,OAAO,EAAE;IACT,UAAU,EAAE;IACZ,OAAO,EAAE;IACT,YAAY,EAAE;AAChB;AAGO,SAAS;IACd,MAAM,QAAuB,EAAE;IAC/B,MAAM,cAAc;QAAC;QAAO;QAAc;QAAU;KAAW;IAE/D,SAAS,WAAW,CAAC,OAAO,CAAC,CAAA;QAC3B,IAAK,IAAI,IAAI,GAAG,KAAK,IAAI,WAAW,EAAE,IAAK;YACzC,MAAM,aAAa,KAAK,MAAM,KAAK;YACnC,MAAM,IAAI,CAAC;gBACT,IAAI,MAAM,MAAM,GAAG;gBACnB,QAAQ,IAAI,EAAE;gBACd,aAAa,GAAG,OAAO,YAAY,CAAC,KAAK,KAAK,IAAI,CAAC,IAAI,KAAK,CAAC,EAAE,OAAO,IAAI,MAAM,IAAI,QAAQ,CAAC,GAAG,MAAM;gBACtG,WAAW,IAAI,OAAO,IAAI,gBAAgB,IAAI,OAAO,IAAI,aAAa;gBACtE,QAAQ,aAAa,WAAW;gBAChC,kBAAkB,aAAa,aAAa;gBAC5C,WAAW,CAAC,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC,EAAE,GAAG;gBAClC,oBAAoB,IAAI,OAAO,WAAW;YAC5C;QACF;IACF;IAEA,SAAS,KAAK,GAAG;AACnB;AAGO,eAAe;IACpB,OAAO,SAAS,WAAW;AAC7B;AAEO,eAAe,gBAAgB,KAAc;IAClD,IAAI,OAAO;QACT,OAAO,SAAS,KAAK,CAAC,MAAM,CAAC,CAAA,IAAK,EAAE,MAAM,KAAK;IACjD;IACA,OAAO,SAAS,KAAK;AACvB;AAEO,eAAe,iBAAiB,MAAc;IACnD,OAAO,SAAS,KAAK,CAAC,MAAM,CAAC,CAAA,IAAK,EAAE,MAAM,KAAK;AACjD;AAEO,eAAe,iBAAiB,MAAc,EAAE,MAAc;IACnE,MAAM,OAAO,SAAS,KAAK,CAAC,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;IAC/C,IAAI,MAAM;QACR,KAAK,MAAM,GAAG;QACd,KAAK,gBAAgB,GAAG,WAAW,WAAW,aAAa;QAC3D,KAAK,kBAAkB,GAAG,IAAI,OAAO,WAAW;IAClD;IACA,OAAO;AACT;AAEO,eAAe,cAAc,OAAyB;IAC3D,MAAM,aAAsB;QAC1B,IAAI,SAAS,QAAQ,CAAC,MAAM,GAAG;QAC/B,SAAS,QAAQ,OAAO;QACxB,SAAS,QAAQ,OAAO;QACxB,mBAAmB,CAAC,GAAG,EAAE,KAAK,GAAG,IAAI;QACrC,YAAY,QAAQ,UAAU;QAC9B,UAAU,QAAQ,QAAQ,IAAI;QAC9B,gBAAgB;QAChB,cAAc,QAAQ,YAAY,IAAI;QACtC,gBAAgB,QAAQ,cAAc;IACxC;IACA,SAAS,QAAQ,CAAC,IAAI,CAAC;IACvB,OAAO;AACT;AAEO,eAAe,YAAY,MAAe;IAC/C,IAAI,QAAQ;QACV,OAAO,SAAS,QAAQ,CAAC,MAAM,CAAC,CAAA,IAAK,EAAE,OAAO,KAAK;IACrD;IACA,OAAO,SAAS,QAAQ;AAC1B;AAEO,eAAe,cAAc,UAAe;IACjD,SAAS,UAAU,CAAC,IAAI,CAAC;QACvB,IAAI,SAAS,UAAU,CAAC,MAAM,GAAG;QACjC,WAAW,IAAI,OAAO,WAAW;QACjC,GAAG,UAAU;IACf;AACF;AAEO,eAAe,aAAa,KAAa,EAAE,IAAa;IAC7D,MAAM,UAAU,QAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;IAC9D,MAAM,cAAc,SAAS,QAAQ,CAAC,MAAM,CAAC,CAAA,IAAK,EAAE,MAAM,KAAK;IAC/D,MAAM,eAAe,YAAY,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,YAAY,EAAE;IAE1E,OAAO;QACL,QAAQ;QACR,MAAM;QACN,gBAAgB,YAAY,MAAM;QAClC,eAAe;QACf,mBAAmB,CAAC,AAAC,SAAS,KAAK,CAAC,MAAM,CAAC,CAAA,IAAK,EAAE,MAAM,KAAK,SAAS,EAAE,gBAAgB,KAAK,YAAY,MAAM,GAAG,SAAS,KAAK,CAAC,MAAM,CAAC,CAAA,IAAK,EAAE,MAAM,KAAK,OAAO,MAAM,GAAI,GAAG,EAAE,OAAO,CAAC;IAC1L;AACF"}},
    {"offset": {"line": 198, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Irfan/Downloads/OOM%20Mini%20project/app/api/bookings/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { createBooking, getBookings } from '@/lib/db'\n\nexport async function GET(request: NextRequest) {\n  try {\n    const userId = request.nextUrl.searchParams.get('user_id')\n    const bookings = await getBookings(userId ? parseInt(userId) : undefined)\n\n    return NextResponse.json({\n      success: true,\n      data: bookings,\n      count: bookings.length\n    })\n  } catch (error) {\n    return NextResponse.json(\n      { success: false, error: 'Failed to fetch bookings' },\n      { status: 500 }\n    )\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json()\n    const { user_id, slot_id, lot_id, start_time, expected_duration_minutes, vehicle_number, total_amount } = body\n\n    if (!user_id || !slot_id || !lot_id || !start_time) {\n      return NextResponse.json(\n        { success: false, error: 'Missing required fields' },\n        { status: 400 }\n      )\n    }\n\n    const booking = await createBooking({\n      user_id,\n      slot_id,\n      start_time,\n      total_amount,\n      vehicle_number\n    })\n\n    return NextResponse.json({\n      success: true,\n      message: 'Booking created successfully',\n      data: booking\n    })\n  } catch (error) {\n    return NextResponse.json(\n      { success: false, error: 'Failed to create booking' },\n      { status: 500 }\n    )\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,SAAS,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC;QAChD,MAAM,WAAW,MAAM,IAAA,0HAAW,EAAC,SAAS,SAAS,UAAU;QAE/D,OAAO,+QAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,MAAM;YACN,OAAO,SAAS,MAAM;QACxB;IACF,EAAE,OAAO,OAAO;QACd,OAAO,+QAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAO,OAAO;QAA2B,GACpD;YAAE,QAAQ;QAAI;IAElB;AACF;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,UAAU,EAAE,yBAAyB,EAAE,cAAc,EAAE,YAAY,EAAE,GAAG;QAE1G,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,UAAU,CAAC,YAAY;YAClD,OAAO,+QAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAA0B,GACnD;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,UAAU,MAAM,IAAA,4HAAa,EAAC;YAClC;YACA;YACA;YACA;YACA;QACF;QAEA,OAAO,+QAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,SAAS;YACT,MAAM;QACR;IACF,EAAE,OAAO,OAAO;QACd,OAAO,+QAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAO,OAAO;QAA2B,GACpD;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}